(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/scene/scene"],{"23de":function(e,t,i){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i={data:function(){return{state:!0,imagelist:[],imgid:[],upid:"",id:"",windowHeight:"",imgshow:"",video:"",video_id:"",new_img:[],old_id:[],height:""}},onLoad:function(){var t=this;t.windowHeight=this.statusBarHeight+44,e.getStorage({key:"userinfo",success:function(e){t.id=e.data.id,t.getinfo()}})},onReady:function(){this.getTopheight()},methods:{getTopheight:function(){var t=this;e.getSystemInfo({success:function(e){t.height=e.statusBarHeight+44+"px"}})},sub_video:function(){var t=this;plus.gallery.pick(function(i){t.video=i,e.showLoading({title:"视频上传中"}),e.uploadFile({url:t.serveipd+"/ajax/upfile",filePath:i,name:"upfile",formData:{},success:function(i){e.hideLoading(),t.video_id=JSON.parse(i.data).id}})},function(e){},{filter:"video",multiple:!1})},getinfo:function(){var t=this;e.request({url:t.serveipd+"/api/merchant/auth/info/"+t.id,method:"GET",data:{id:t.id},success:function(e){t.video=e.data.data.otherProvePicUrls[0],void 0!=t.video&&(t.video_id=t.video.slice(-4));for(var i=e.data.data.inPicUrls,a=0;a<i.length;a++)t.imagelist.push(i[a]);t.old_id=t.imagelist}})},video_fuc:function(){this.state=!0},img_fuc:function(){this.state=!1},chooseImage:function(t){var i=this,a=[];e.chooseImage({sourceType:["album","camera"],sizeType:["original"],success:function(e){i.new_img=i.new_img.concat(e.tempFilePaths),a=a.concat(e.tempFilePaths),i.imagelist=i.imagelist.concat(a)}})},del_img:function(e){var t=this;t.imagelist.splice(e,1),t.old_id.splice(e,1)},del_vieo:function(){this.video="",console.log(1),this.video_id="",console.log(this.video)},back:function(){e.navigateBack({delta:1})},preserve:function(t){var i=this,a=this;e.showLoading({});for(var s=[],n=0;n<a.old_id.length;n++){var o="";o=a.old_id[n].slice(-4),s.push(o)}if(console.log(1),0==a.new_img.length)e.request({url:this.serveipd+"/api/merchant/photo/add",method:"POST",header:{"content-type":"application/x-www-form-urlencoded"},data:{image:s,merchantId:parseInt(a.id),type:parseInt(1),videos:a.video_id},success:function(t){e.hideLoading(),e.redirectTo({url:"../user/index"})}});else for(var c=0;c<a.new_img.length;c++)e.uploadFile({url:a.serveipd+"/ajax/upfile",filePath:a.new_img[c],name:"upfile",formData:{},success:function(t){a.imgid.push(JSON.parse(t.data).id),a.imgid.length==a.new_img.length&&(a.upid=a.imgid.concat(s).toString(),e.request({url:i.serveipd+"/api/merchant/photo/add",method:"POST",header:{"content-type":"application/x-www-form-urlencoded"},data:{image:a.upid,merchantId:parseInt(a.id),type:parseInt(1),videos:a.video_id},success:function(t){e.hideLoading(),e.redirectTo({url:"../user/index"})}}))}})}}};t.default=i}).call(this,i("6e42")["default"])},"3bcf":function(e,t,i){},"922b":function(e,t,i){"use strict";var a=i("3bcf"),s=i.n(a);s.a},"9e65":function(e,t,i){"use strict";i.r(t);var a=i("a770"),s=i("badc");for(var n in s)"default"!==n&&function(e){i.d(t,e,function(){return s[e]})}(n);i("922b");var o=i("2877"),c=Object(o["a"])(s["default"],a["a"],a["b"],!1,null,null,null);t["default"]=c.exports},a770:function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("view",[i("view",{staticClass:"navigation",style:{height:e.height}},[i("navigator",{staticClass:"left",attrs:{"open-type":"navigateBack","hover-class":"none"}},[i("image",{attrs:{src:"../../static/Merchan_registration/back.png",mode:""}})]),i("view",{staticClass:"title"},[e._v("店铺实景")]),i("view",{staticClass:"right",attrs:{eventid:"51007836-0"},on:{tap:e.preserve}},[e._v("上传")])],1),i("view",{staticClass:"content",style:{paddingTop:e.height}},[i("view",{staticClass:"banner"},[e.state?i("view",{staticClass:"ban_video"},[i("video",{attrs:{src:e.video}})]):i("swiper",{staticClass:"ban_img",attrs:{"scroll-x":"true"}},e._l(e.imagelist,function(e,t){return i("swiper-item",{key:t,attrs:{mpcomid:"51007836-0-"+t}},[i("image",{attrs:{src:e,mode:"aspectFit"}})])}))],1),i("view",{staticClass:"ban_btn"},[i("view",{class:e.state?"video_btn_c":"video_btn",attrs:{eventid:"51007836-1"},on:{tap:function(t){e.state=!0}}},[e._v("视频")]),i("view",{class:e.state?"img_btn":"img_btn_c",attrs:{eventid:"51007836-2"},on:{tap:function(t){e.state=!1}}},[e._v("图片")])]),i("view",{staticClass:"imgbox"},[i("view",{staticClass:"video",attrs:{eventid:"51007836-4"},on:{tap:function(t){e.sub_video()}}},[""!=e.video?i("video",{attrs:{src:e.video}}):e._e(),i("image",{key:e.index,staticClass:"del_img",attrs:{src:"../../static/scene/del_img.png",eventid:"51007836-3"},on:{tap:e.del_vieo}}),""==e.video?i("image",{staticClass:"upimg",attrs:{src:"../../static/scene/upimg.png"}}):e._e()]),e._l(e.imagelist,function(t,a){return i("view",{key:a},[i("view",{staticClass:"img_view"},[i("image",{key:a,staticClass:"del_img",attrs:{src:"../../static/scene/del_img.png",mode:"aspectFit",eventid:"51007836-5-"+a},on:{tap:function(t){e.del_img(a)}}}),i("image",{staticClass:"upimg",attrs:{src:t}})])])}),i("view",{staticClass:"img_view",attrs:{eventid:"51007836-6"},on:{tap:e.chooseImage}},[i("image",{staticClass:"upimg",attrs:{src:"../../static/scene/upimg.png"}})])],2)])])},s=[];i.d(t,"a",function(){return a}),i.d(t,"b",function(){return s})},ad41:function(e,t,i){"use strict";i("b007");var a=n(i("b0ce")),s=n(i("9e65"));function n(e){return e&&e.__esModule?e:{default:e}}Page((0,a.default)(s.default))},badc:function(e,t,i){"use strict";i.r(t);var a=i("23de"),s=i.n(a);for(var n in a)"default"!==n&&function(e){i.d(t,e,function(){return a[e]})}(n);t["default"]=s.a}},[["ad41","common/runtime","common/vendor"]]]);