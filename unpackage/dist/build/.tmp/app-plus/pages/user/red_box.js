(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/user/red_box"],{4132:function(t,e,i){},"718f":function(t,e,i){"use strict";i.r(e);var a=i("91c8"),n=i.n(a);for(var s in a)"default"!==s&&function(t){i.d(e,t,function(){return a[t]})}(s);e["default"]=n.a},8831:function(t,e,i){"use strict";var a=i("4132"),n=i.n(a);n.a},"91c8":function(t,e,i){"use strict";(function(t){function i(t){var e=new Date,i=e.getFullYear(),a=e.getMonth()+1,n=e.getDate();return"start"===t?i-=100:"end"===t&&(i+=100),a=a>9?a:"0"+a,n=n>9?n:"0"+n,"".concat(i,"-").concat(a,"-").concat(n)}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a={data:function(){return{height:"",date:i({format:!0}),startTime:"",endTime:"",tg:"none",limit_bt:!0,grant:"",merchantId:"",price:"",number:"",activitiesId:"",modify:"/api/merchant/red/modify",establish:"/api/merchant/red/envelope",address:""}},onLoad:function(e){var i=this;console.log(e),i.activitiesId=e.activitiesId,t.getStorage({key:"userinfo",success:function(t){i.merchantId=t.data.id,void 0!=e.activitiesId&&i.getInfor()}})},onReady:function(){this.getTopheight()},methods:{getTopheight:function(){var e=this;t.getSystemInfo({success:function(t){e.height=t.statusBarHeight+44+"px"}})},start_times:function(t){this.startTime=t.target.value},endTimes:function(t){this.endTime=t.target.value},determine:function(){var e=/^[1-9]\d*$/;if(0==this.limit_bt)this.grant="无限制";else{if(""==this.grant)return void t.showToast({title:"发放数量不能为空",icon:"none",mask:!1,duration:2e3});if(!e.test(this.grant))return void t.showToast({title:"发放数量输入有误",icon:"none",mask:!1,duration:2e3})}this.tg="none"},cancel:function(){this.tg="none"},limit:function(t){console.log(t.detail.value),this.limit_bt=t.detail.value},sub:function(){var e=this;void 0==e.activitiesId?e.address=e.establish:e.address=e.modify,t.showLoading({title:"生成红包活动中",mask:!1});var i=/^[+-]?\d+(\.\d+)?$|^$|^(\d+|\-){7,}$/;if(""!=e.startTime)if(""!=e.endTime){var a=new Date(e.startTime),n=new Date(e.endTime);a.getTime()>n.getTime()?t.showToast({title:"结束时间不能小于开始时间",icon:"none",mask:!1,duration:2e3}):""!=e.price?i.test(e.price)?""!=e.grant?(this.limit_bt?e.number=e.grant:e.number="",t.request({url:e.serveipd+e.address,method:"POST",data:{id:parseInt(e.activitiesId),merchantId:e.merchantId,startTime:e.startTime,endTime:e.endTime,price:e.price,quantity:e.number,consumedAllHours:e.limit_bt?1:0},success:function(e){t.hideLoading(),t.showToast({title:e.data.msg,icon:"none",mask:!1,duration:1500,success:function(){0==e.data.code&&setTimeout(function(){t.redirectTo({url:"./marketing"})},1500)}})}})):t.showToast({title:"请选择发放数量",icon:"none",mask:!1,duration:2e3}):t.showToast({title:"金额输入有误",icon:"none",mask:!1,duration:2e3}):t.showToast({title:"请输入金额",icon:"none",mask:!1,duration:2e3})}else t.showToast({title:"请选择结束时间",icon:"none",mask:!1,duration:2e3});else t.showToast({title:"请选择开始时间",icon:"none",mask:!1,duration:2e3})},getInfor:function(){var e=this;t.request({url:this.serveipd+"/api/merchant/red/information",header:{content_type:"application/json"},method:"GET",data:{merchantId:e.merchantId,id:e.activitiesId},success:function(t){e.startTime=t.data.data.startTime,e.endTime=t.data.data.endTime,e.price=t.data.data.price,1==t.data.data.consumedAllHours?(e.limit_bt=!0,e.grant=t.data.data.quantity):(e.limit_bt=!1,e.grant="无限制")},fail:function(){},complete:function(){}})}}};e.default=a}).call(this,i("6e42")["default"])},b171:function(t,e,i){"use strict";i("b007");var a=s(i("b0ce")),n=s(i("e94f"));function s(t){return t&&t.__esModule?t:{default:t}}Page((0,a.default)(n.default))},da20:function(t,e,i){"use strict";var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("view",[i("view",{staticClass:"navigation",style:{height:t.height}},[i("navigator",{staticClass:"left",attrs:{"open-type":"navigateBack","hover-class":"none"}},[i("image",{attrs:{src:"../../static/Merchan_registration/back.png",mode:""}})]),i("view",{staticClass:"title"},[t._v("创建红包")]),i("view",{staticClass:"right"})],1),i("view",{staticClass:"content",style:{paddingTop:t.height}},[i("view",{staticClass:"div_list"},[i("text",[t._v("开始日期")]),i("picker",{attrs:{mode:"date",value:t.date,start:t.startDate,end:t.endDate,eventid:"c3bb6086-0"},on:{change:t.start_times}},[i("text",{directives:[{name:"show",rawName:"v-show",value:""==t.startTime,expression:"startTime==''"}]},[t._v("请选择开始时间")]),i("text",[t._v(t._s(t.startTime))]),i("image",{attrs:{src:"../../static/user/right.png",mode:""}})])],1),i("view",{staticClass:"div_list"},[i("text",[t._v("结束日期")]),i("picker",{attrs:{mode:"date",value:t.date,start:t.startDate,end:t.endDate,eventid:"c3bb6086-1"},on:{change:t.endTimes}},[i("text",{directives:[{name:"show",rawName:"v-show",value:""==t.endTime,expression:"endTime==''"}]},[t._v("请选择结束时间")]),i("text",[t._v(t._s(t.endTime))]),i("image",{attrs:{src:"../../static/user/right.png",mode:""}})])],1),i("view",{staticClass:"div_list"},[i("text",[t._v("设定金额")]),i("view",{staticClass:"put"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.price,expression:"price"}],attrs:{type:"text",placeholder:"请输入金额",eventid:"c3bb6086-2"},domProps:{value:t.price},on:{input:function(e){e.target.composing||(t.price=e.target.value)}}}),i("image",{attrs:{src:"../../static/user/right.png",mode:""}})])]),i("view",{staticClass:"div_list",attrs:{eventid:"c3bb6086-3"},on:{tap:function(e){t.tg="block",t.grant=""}}},[i("text",[t._v("发放数量")]),i("view",[""==t.grant?i("text",[t._v("点击选择")]):i("text",[t._v(t._s(t.grant))]),i("image",{attrs:{src:"../../static/user/right.png",mode:""}})])]),i("button",{attrs:{type:"primary",eventid:"c3bb6086-4"},on:{tap:t.sub}},[t._v("确定")]),i("view",{staticClass:"mask",style:{display:t.tg}},[i("view",{staticClass:"norms"},[i("view",{staticClass:"title"},[t._v("发放数量")]),i("view",{staticClass:"div_list"},[i("text",[t._v("限制发放数量")]),i("switch",{attrs:{checked:t.limit_bt,eventid:"c3bb6086-5"},on:{change:t.limit}})]),i("view",{directives:[{name:"show",rawName:"v-show",value:t.limit_bt,expression:"limit_bt"}],staticClass:"div_list"},[i("text",[t._v("制定发放数量")]),i("input",{directives:[{name:"model",rawName:"v-model",value:t.grant,expression:"grant"}],staticClass:"grant_num",attrs:{type:"text",placeholder:"输入数量",eventid:"c3bb6086-6"},domProps:{value:t.grant},on:{input:function(e){e.target.composing||(t.grant=e.target.value)}}})]),i("view",{staticClass:"btn"},[i("text",{staticClass:"cancel",attrs:{eventid:"c3bb6086-7"},on:{tap:function(e){t.cancel()}}},[t._v("取消")]),i("text",{staticClass:"determine",attrs:{eventid:"c3bb6086-8"},on:{tap:function(e){t.determine()}}},[t._v("确定")])])])])],1)])},n=[];i.d(e,"a",function(){return a}),i.d(e,"b",function(){return n})},e94f:function(t,e,i){"use strict";i.r(e);var a=i("da20"),n=i("718f");for(var s in n)"default"!==s&&function(t){i.d(e,t,function(){return n[t]})}(s);i("8831");var r=i("2877"),o=Object(r["a"])(n["default"],a["a"],a["b"],!1,null,null,null);e["default"]=o.exports}},[["b171","common/runtime","common/vendor"]]]);